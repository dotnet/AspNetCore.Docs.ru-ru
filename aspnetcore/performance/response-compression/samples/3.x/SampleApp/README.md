# <a name="response-compression-sample-application-aspnet-core-3x"></a>Пример приложения для сжатия ответа (ASP.NET Core 3. x)

В этом примере показано использование по промежуточного слоя сжатия ответа ASP.NET Core 3. x для сжатия HTTP-ответов. В примере демонстрируются поставщики gzip, Brotli и пользовательский алгоритм сжатия для текстовых и графических ответов, а также показано, как добавить тип MIME для сжатия. Пример ASP.NET Core 2. x см. в разделе [пример приложения для сжатия ответа (ASP.NET Core 2. x)](https://github.com/dotnet/AspNetCore.Docs/tree/main/aspnetcore/performance/response-compression/samples/2.x).

## <a name="examples-in-this-sample"></a>Включенные примеры

* `BrotliCompressionProvider`
  * `text/plain`
    * **/** -Lorem Ipsum ответ текстового файла в 2 044 байт, который сжимается до ~ 979 байт.
    * **/testfile1kb.txt** — ответ текстового файла на 1 033 байт, который сжимается до ~ 36 байт.
    * **/триккле** — ответ выдается как одиночные символы с интервалом в 1 секунду.
* `GzipCompressionProvider`
  * `text/plain`
    * **/** -Lorem Ipsum ответ текстового файла в 2 044 байт, который сжимается до ~ 927 байт.
    * **/testfile1kb.txt** — ответ текстового файла на 1 033 байт, который сжимается до ~ 47 байт.
    * **/триккле** — ответ выдается как одиночные символы с интервалом в 1 секунду.
  * `image/svg+xml`
    * **/баннер.СВГ** — ответ с изображением масштабируемой векторной графики (SVG) в 9 707 байт, который сжимается до ~ 4 459 байт.
* `CustomCompressionProvider`<br>Показывает, как реализовать пользовательский поставщик сжатия для использования с по промежуточного слоя.

Когда запрос включает `Accept-Encoding` сжатие заголовка и ответа, по промежуточного слоя автоматически добавляет `Vary: Accept-Encoding` заголовок в ответ. `Vary`Заголовок указывает кэшам поддерживать несколько копий ответа на основе альтернативных значений `Accept-Encoding` , поэтому сжатые (gzip или Brotli) и несжатые версии хранятся в кэшах для систем, которые могут принимать сжатый или несжатый ответ.

## <a name="use-the-sample"></a>Использование примера

1. Выполните запрос с помощью [Fiddler](https://www.telerik.com/fiddler), [Firebug](https://getfirebug.com/)или [POST](https://www.getpostman.com/) в приложении без `Accept-Encoding` заголовка и запишите полезные данные ответа, размер ответа и заголовки ответа.
1. Добавьте `Accept-Encoding: br` заголовок или `Accept-Encoding: gzip` и запишите размер сжатого отклика и заголовков ответа. Размер ответа `Content-Encoding` уменьшается, а заголовок ответа включается по промежуточного слоя, что означает, что сжатие происходит с помощью gzip или Brotli. При просмотре текста ответа для Lorem Ipsum или ответа на **testfile1kb.txt** вы видите, что текст сжат и нечитаем.
1. Добавьте `Accept-Encoding: mycustomcompression` заголовок и запишите заголовки ответа. `CustomCompressionProvider`— Это пустая реализация, которая фактически не сжимает ответ, но можно создать настраиваемую оболочку потока сжатия для `CreateStream()` метода.
