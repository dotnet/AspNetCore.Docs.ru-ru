---
title: Управление пользователями и группами в SignalR
author: bradygaster
description: Общие сведения о ASP.NET Core SignalR управлении пользователями и группами.
monikerRange: '>= aspnetcore-2.1'
ms.author: bradyg
ms.custom: mvc
ms.date: 05/17/2020
no-loc:
- appsettings.json
- ASP.NET Core Identity
- cookie
- Cookie
- Blazor
- Blazor Server
- Blazor WebAssembly
- Identity
- Let's Encrypt
- Razor
- SignalR
uid: signalr/groups
ms.openlocfilehash: 8f9e91f34386bb5b4cf79bee429a39ae27c03c5e
ms.sourcegitcommit: 54fe1ae5e7d068e27376d562183ef9ddc7afc432
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 03/10/2021
ms.locfileid: "102589222"
---
# <a name="manage-users-and-groups-in-signalr"></a>Управление пользователями и группами в SignalR

По [Бреннан Конрой](https://github.com/BrennanConroy)

SignalR разрешает отправлять сообщения всем соединениям, связанным с конкретным пользователем, а также именованным группам подключений.

[Просмотреть или скачать образец кода](https://github.com/dotnet/AspNetCore.Docs/tree/main/aspnetcore/signalr/groups/sample/) [(описание загрузки)](xref:index#how-to-download-a-sample)

## <a name="users-in-signalr"></a>Пользователи в SignalR

Один пользователь в SignalR может иметь несколько подключений к приложению. Например, пользователь может подключаться к рабочему столу, а также по телефону. Каждое устройство имеет отдельное SignalR соединение, но все они связаны с одним и тем же пользователем. При отправке пользователю сообщения все соединения, связанные с этим пользователем, получают сообщение. Доступ к идентификатору пользователя для соединения может осуществляться `Context.UserIdentifier` свойством в концентраторе.

По умолчанию SignalR использует `ClaimTypes.NameIdentifier` из из, `ClaimsPrincipal` связанного с соединением, в качестве идентификатора пользователя. Сведения о настройке этого поведения см. в разделе [использование утверждений для настройки обработки удостоверений](xref:signalr/authn-and-authz#use-claims-to-customize-identity-handling).

Отправьте сообщение определенному пользователю, передав идентификатор пользователя в `User` функцию в методе концентратора, как показано в следующем примере:

> [!NOTE]
> В идентификаторе пользователя учитывается регистр.

[!code-csharp[Configure service](groups/sample/Hubs/ChatHub.cs?range=29-32)]

## <a name="groups-in-signalr"></a>Группы в SignalR

Группа — это коллекция соединений, связанных с именем. Сообщения могут отправляться всем подключениям в группе. Группы — это рекомендуемый способ отправки на подключение или несколько подключений, так как группы управляются приложением. Соединение может быть членом нескольких групп. Группы идеально подходят для приложения разговора, где каждая комната может быть представлена группой. Соединения добавляются в группы или удаляются из групп с помощью `AddToGroupAsync` `RemoveFromGroupAsync` методов и.

[!code-csharp[Hub methods](groups/sample/Hubs/ChatHub.cs?range=15-27)]

Членство в группе не сохраняется при повторном подключении подключения. Соединение должно повторно присоединиться к группе, когда она будет восстановлена. Невозможно подсчитать членов группы, так как эта информация недоступна, если приложение масштабируется до нескольких серверов.

Чтобы защитить доступ к ресурсам при использовании групп, используйте функции [проверки подлинности и авторизации](xref:signalr/authn-and-authz) в ASP.NET Core. Если пользователь добавлен в группу только в том случае, если учетные данные действительны для этой группы, сообщения, отправленные в эту группу, будут отправляться только полномочным пользователям. Однако группы не являются функцией безопасности. Утверждения проверки подлинности имеют функции, которые не являются группами, например срок действия и отзыв. Если разрешение пользователя на доступ к группе отменено, приложение должно явным образом удалить пользователя из группы.

> [!NOTE]
> В именах групп учитывается регистр.

## <a name="related-resources"></a>Связанные ресурсы

* [Начало работы](xref:tutorials/signalr)
* [Концентраторы](xref:signalr/hubs)
* [Публикация в Azure](xref:signalr/publish-to-azure-web-app)
